# カレンダーの作り方

## 見た目と機能をイメージする

まずはどんな見た目のカレンダーか、どんな機能を持ったカレンダーなのかを確認。<br>
デザインがあれば見た目と機能がわかりやすいので、そこから考える。<br>
今回はお「お手本」があるので、お手本を見てどんな機能が必要か考えてみる。

### 今回作るカレンダー

- ヘッダーに yyyy 年 m 月を表示
- 先月、翌月を切り替える機能（ボタンを作る）prev next
- 初期状態は今月を表示する
- 日曜日始まりで、カレンダーテーブルの上に曜日(日・月・火・水・木・金・土・日)を表示
- 左上のセルが空く場合は先月の日付をグレーアウトで入れる
- 右下のセルが空く場合は翌月の日付をグレーアウトで入れる
- 今日の日付はハイライトさせる

---

## 前提知識

### Date オブジェクト

```
————————————————————————————————————————————————————————————
new Date()                    // 今日の日付データ 取得
new Date(year, month, 1)      // 月初 取得
new Date(year, month + 1, 0)  // 月末 取得
date.getDay()                // 曜日（日曜日から0,1,3... 土曜日は6） 取得
date.setDate(date.getDate() + n) // 日付加算 セッティング 実行
————————————————————————————————————————————————————————————
```

日付加算ができるというのがミソ

### HTML の動的描画

```
selector.textContent // selectorの中のテキストを変更
selector.innerHTML // selectorの中のHTMLを変更

```

---

## 作り方フロー

- html で枠組みを作る （半分は template で作成済み 細かいところはお手本を見て）
- 静的にカレンダー中身を作って構造と style を決めちゃおう（template で作成済み）

### ここからが今回の本番

- **「状態管理 + 純粋関数 + 再描画」で考える**
- ざっくりでいいから 表示（描画 動的に表示する）、イベント、関数を考える
- 描画は描画専用の関数を実行させてやることにしよう。関数の名前は render としよう。
- ヘッダーに Date 関数を使って今月の「yyyy 年 m 月」を描画
- 曜日（DOW）を描画
- カレンダーセルの中身を描画したいけど、するためには何が必要か？

  - 日付の情報をが入った配列がほしいな
  - 日付情報配列を innerHTML と map を使って描画すればいいんじゃね？
  - じゃ日付情報配列を生成する関数をつくろうか。いったん定義しておこう。（buildCalenderCell としよう）
  - その関数を使うときに年、月を指定したら、カレンダーに必要なマスの配列を返してくれるようにしよう。
  - ```
    function buildCalenderCell(year, month){
      ...
      ...
      ...
      return [1日の情報, 2日の情報, 3日の情報];
    }
    ```

  - カレンダーのマスってどんな感じ？
  - 最大 42 マス（6 週分）になるので、それを考えるか。
  - いったん 42 個の配列を作る?
  - 配列中身はどんなものにしたい？どんな情報を入れたい？
  - 日付、今日（today）、今月（isCurrentMonth）ほしいよね
  - date（num）,isCurrentMonth（boolen）,isToday（boolen）を持ったオブジェクトを配列の中に入れようか。
  - こんなデータはどうかな？
  - ```
      const cells = [
        {
          date: 1,
          isCurrentMonth: true,
          isToday: false
        },
        {
          date: 2,
          isCurrentMonth: true,
          isToday: false
        },
        {
          date: 3,
          isCurrentMonth: true,
          isToday: true
        },
        ...
        ...
      ]
    ```

  - カレンダーの曜日位置合わせどうしよう。
  - 月初めが日曜日であれば気にしなくてもいいけど...
  - そもそも月の初めが日曜日じゃない場合、先月のお尻を日曜日から入れる必要あるよね。
  - となると ↓ こんなデータになるのかな。
  - ```
     const cells = [
      {
         date: 29,
         isCurrentMonth: false,
         isToday: false
       },
       {
         date: 30,
         isCurrentMonth: false,
         isToday: false
       },
       {
         date: 31,
         isCurrentMonth: false,
         isToday: false
       },
       {
         date: 1,
         isCurrentMonth: true,
         isToday: false
       },
       {
         date: 2,
         isCurrentMonth: true,
         isToday: false
       },
       {
         date: 3,
         isCurrentMonth: true,
         isToday: true
       },
       ...
       ...
     ]
    ```

  - これをどうやって動的に生成しようか...
  - `date.getDay()`で日曜日を 0 とした数字を取れるらしいぞ！
  - Date オブジェクト日にちを引いたり足したりできるぞ！
  - ということは対象月 1 日の曜日を取得（number）して、その値を 1 日から引けばいいじゃん！
  - 後は for 文で 42 回まわして、1 日ずつ足していこう！
  - 今月かどうかの判定、isCurrentMonth はどうすればいいかな？
  - 引数で受け取ってる month と for 文の中の日付データの month を比較すればいけるか。
  - isToday はどうする？
  - new Date()と for 文の中の日付データを比較すればいけるか。
  - 同じ日付でも時間が一致しない...じゃ年、月、日だけで比較するか。
  - 最後に気が向いたら比較するやつ ↑ を関数かしておくか。
  - できた配列を return でえい！

- 出来上がった cell データを描画じゃい！
- 今月じゃないセルはグレーアウトしたいから、クラス名に outside というクラスをつけよう
- 今日のセルはハイライトしたいからクラス名に toDay をつけよう
- 先月翌月ボタンで切り替えるのはどうしようか。
- render(年,月)みたく引数を持たせる？ いや年、月は state で管理したほうが vue や react っぽくて分かりやすいじゃん！
- state オブジェクトを作って今表示してる年と月を管理しよう
- render()の中身も state から情報を取得しよう
- prev,next ボタンをクリックしたら、state を変更して再 render()

### 完成
